<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tax Invoice - {{invoiceNumber}}</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 11px;
      line-height: 1.4;
      color: #333;
      background: #fff;
    }
    .invoice-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      border-bottom: 2px solid #1a5276;
      padding-bottom: 15px;
      margin-bottom: 10px;
    }
    .logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .logo-section img {
      max-height: 60px;
      max-width: 150px;
    }
    .company-name {
      font-size: 24px;
      font-weight: bold;
      color: #1a5276;
    }
    .invoice-title-section {
      text-align: right;
    }
    .invoice-title {
      font-size: 22px;
      font-weight: bold;
      color: #1a5276;
      margin-bottom: 5px;
    }
    .invoice-type {
      font-size: 12px;
      color: #666;
      font-style: italic;
    }
    .invoice-meta {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 15px;
    }
    .invoice-meta-table {
      border-collapse: collapse;
    }
    .invoice-meta-table td {
      padding: 3px 8px;
      border: 1px solid #ddd;
    }
    .invoice-meta-table td:first-child {
      background: #f5f5f5;
      font-weight: 500;
    }
    .details-section {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      gap: 20px;
    }
    .details-box {
      flex: 1;
      border: 1px solid #ddd;
      padding: 12px;
      border-radius: 4px;
    }
    .details-box h3 {
      font-size: 12px;
      color: #1a5276;
      margin-bottom: 8px;
      padding-bottom: 5px;
      border-bottom: 1px solid #eee;
    }
    .details-row {
      display: flex;
      margin-bottom: 4px;
    }
    .details-label {
      width: 100px;
      font-weight: 500;
      color: #555;
    }
    .details-value {
      flex: 1;
    }
    .items-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }
    .items-table th {
      background: #1a5276;
      color: white;
      padding: 8px 6px;
      text-align: center;
      font-size: 10px;
      font-weight: 600;
    }
    .items-table td {
      padding: 8px 6px;
      border: 1px solid #ddd;
      text-align: center;
    }
    .items-table td:nth-child(2) {
      text-align: left;
    }
    .items-table .subtotal-row {
      background: #f8f9fa;
      font-weight: 600;
    }
    .items-table .total-row {
      background: #e8f4f8;
      font-weight: 700;
    }
    .tax-header {
      background: #2980b9 !important;
    }
    .amount-section {
      margin-bottom: 15px;
    }
    .amount-words {
      background: #f8f9fa;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .amount-words strong {
      color: #1a5276;
    }
    .payment-info {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }
    .payment-box {
      flex: 1;
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 4px;
    }
    .payment-box h4 {
      font-size: 11px;
      color: #1a5276;
      margin-bottom: 6px;
    }
    .terms-section {
      border: 1px solid #ddd;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .terms-section h4 {
      font-size: 11px;
      color: #1a5276;
      margin-bottom: 6px;
    }
    .terms-section p {
      font-size: 10px;
      color: #666;
      white-space: pre-line;
    }
    .signature-section {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #ddd;
    }
    .signature-box {
      text-align: center;
      min-width: 200px;
    }
    .signature-box .signature-line {
      border-top: 1px solid #333;
      margin-top: 40px;
      padding-top: 5px;
    }
    .signature-box img {
      max-height: 50px;
      max-width: 100px;
    }
    .signature-box .designation {
      font-size: 10px;
      color: #666;
    }
    .footer {
      margin-top: 20px;
      padding-top: 10px;
      border-top: 2px solid #1a5276;
      text-align: center;
      font-size: 9px;
      color: #666;
    }
    .footer-row {
      margin-bottom: 3px;
    }
    @media print {
      body {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div class="header">
      <div class="logo-section">
        {{#if companyLogo}}
        <img src="{{companyLogo}}" alt="{{companyName}}">
        {{/if}}
        <div class="company-name">{{companyName}}</div>
      </div>
      <div class="invoice-title-section">
        <div class="invoice-title">TAX INVOICE</div>
        <div class="invoice-type">ORIGINAL FOR BUYER</div>
      </div>
    </div>

    <div class="invoice-meta">
      <table class="invoice-meta-table">
        <tr>
          <td>Invoice No.</td>
          <td><strong>{{invoiceNumber}}</strong></td>
        </tr>
        <tr>
          <td>Date</td>
          <td>{{invoiceDate}}</td>
        </tr>
      </table>
    </div>

    <div class="details-section">
      <div class="details-box">
        <h3>Student Details</h3>
        <div class="details-row">
          <span class="details-label">Student Code:</span>
          <span class="details-value">{{studentCode}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">Name:</span>
          <span class="details-value">{{studentName}}</span>
        </div>
        {{#if studentAddress}}
        <div class="details-row">
          <span class="details-label">Address:</span>
          <span class="details-value">{{studentAddress}}</span>
        </div>
        {{/if}}
        <div class="details-row">
          <span class="details-label">Email:</span>
          <span class="details-value">{{studentEmail}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">Mobile:</span>
          <span class="details-value">{{studentPhone}}</span>
        </div>
        {{#if studentGstin}}
        <div class="details-row">
          <span class="details-label">GSTIN:</span>
          <span class="details-value">{{studentGstin}}</span>
        </div>
        {{/if}}
        <div class="details-row">
          <span class="details-label">State:</span>
          <span class="details-value">{{studentState}}</span>
        </div>
      </div>

      <div class="details-box">
        <h3>Centre Details</h3>
        <div class="details-row">
          <span class="details-label">Centre:</span>
          <span class="details-value">{{centreName}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">Address:</span>
          <span class="details-value">{{centreAddress}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">City:</span>
          <span class="details-value">{{centreCity}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">Phone:</span>
          <span class="details-value">{{companyPhone}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">GSTIN:</span>
          <span class="details-value">{{companyGstin}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">State:</span>
          <span class="details-value">{{centreState}} ({{centreStateCode}})</span>
        </div>
      </div>
    </div>

    {{#if isInterstate}}
    <table class="items-table">
      <thead>
        <tr>
          <th style="width: 30px;">S.#</th>
          <th>Product Description</th>
          <th style="width: 60px;">HSN Code</th>
          <th style="width: 70px;">Base Fee</th>
          <th style="width: 50px;">Dis.</th>
          <th style="width: 70px;">Taxable Value</th>
          <th colspan="2" class="tax-header" style="width: 100px;">IGST</th>
          <th style="width: 80px;">Total Fee</th>
        </tr>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th class="tax-header">Rate%</th>
          <th class="tax-header">Amt.</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {{#each items}}
        <tr>
          <td>{{serialNo}}</td>
          <td>{{description}}</td>
          <td>{{hsnCode}}</td>
          <td>{{formatCurrency baseFee}}</td>
          <td>{{formatCurrency discount}}</td>
          <td>{{formatCurrency taxableValue}}</td>
          <td>{{igstRate}}%</td>
          <td>{{formatCurrency igstAmount}}</td>
          <td>{{formatCurrency totalFee}}</td>
        </tr>
        {{/each}}
        <tr class="subtotal-row">
          <td colspan="3">Sub Total</td>
          <td>{{formatCurrency subtotalBaseFee}}</td>
          <td>{{formatCurrency subtotalDiscount}}</td>
          <td>{{formatCurrency subtotalTaxable}}</td>
          <td></td>
          <td>{{formatCurrency subtotalIgst}}</td>
          <td>{{formatCurrency subtotalTotal}}</td>
        </tr>
        {{#if adjustmentAmount}}
        <tr>
          <td colspan="8" style="text-align: right;">Less: Adjustment Amt.</td>
          <td>{{formatCurrency adjustmentAmount}}</td>
        </tr>
        {{/if}}
        <tr class="total-row">
          <td colspan="8" style="text-align: right; font-size: 12px;">Total Received</td>
          <td style="font-size: 12px;">{{formatCurrency totalReceived}}</td>
        </tr>
      </tbody>
    </table>
    {{else}}
    <table class="items-table">
      <thead>
        <tr>
          <th style="width: 30px;">S.#</th>
          <th>Product Description</th>
          <th style="width: 60px;">HSN Code</th>
          <th style="width: 70px;">Base Fee</th>
          <th style="width: 50px;">Dis.</th>
          <th style="width: 70px;">Taxable Value</th>
          <th colspan="2" class="tax-header" style="width: 100px;">CGST</th>
          <th colspan="2" class="tax-header" style="width: 100px;">SGST</th>
          <th style="width: 80px;">Total Fee</th>
        </tr>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th class="tax-header">Rate%</th>
          <th class="tax-header">Amt.</th>
          <th class="tax-header">Rate%</th>
          <th class="tax-header">Amt.</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {{#each items}}
        <tr>
          <td>{{serialNo}}</td>
          <td>{{description}}</td>
          <td>{{hsnCode}}</td>
          <td>{{formatCurrency baseFee}}</td>
          <td>{{formatCurrency discount}}</td>
          <td>{{formatCurrency taxableValue}}</td>
          <td>{{cgstRate}}%</td>
          <td>{{formatCurrency cgstAmount}}</td>
          <td>{{sgstRate}}%</td>
          <td>{{formatCurrency sgstAmount}}</td>
          <td>{{formatCurrency totalFee}}</td>
        </tr>
        {{/each}}
        <tr class="subtotal-row">
          <td colspan="3">Sub Total</td>
          <td>{{formatCurrency subtotalBaseFee}}</td>
          <td>{{formatCurrency subtotalDiscount}}</td>
          <td>{{formatCurrency subtotalTaxable}}</td>
          <td></td>
          <td>{{formatCurrency subtotalCgst}}</td>
          <td></td>
          <td>{{formatCurrency subtotalSgst}}</td>
          <td>{{formatCurrency subtotalTotal}}</td>
        </tr>
        {{#if adjustmentAmount}}
        <tr>
          <td colspan="10" style="text-align: right;">Less: Adjustment Amt.</td>
          <td>{{formatCurrency adjustmentAmount}}</td>
        </tr>
        {{/if}}
        <tr class="total-row">
          <td colspan="10" style="text-align: right; font-size: 12px;">Total Received</td>
          <td style="font-size: 12px;">{{formatCurrency totalReceived}}</td>
        </tr>
      </tbody>
    </table>
    {{/if}}

    <div class="amount-section">
      <div class="amount-words">
        <strong>Amount Received (in Words):</strong> {{amountInWords}}
      </div>
    </div>

    <div class="payment-info">
      <div class="payment-box">
        <h4>Payment Details</h4>
        <div class="details-row">
          <span class="details-label">Mode:</span>
          <span class="details-value">{{paymentMode}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">Reference No.:</span>
          <span class="details-value">{{paymentReference}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">Date:</span>
          <span class="details-value">{{paymentDate}}</span>
        </div>
      </div>
      {{#if bankName}}
      <div class="payment-box">
        <h4>Bank Details (For Offline)</h4>
        <div class="details-row">
          <span class="details-label">Bank:</span>
          <span class="details-value">{{bankName}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">A/C No.:</span>
          <span class="details-value">{{accountNumber}}</span>
        </div>
        <div class="details-row">
          <span class="details-label">IFSC:</span>
          <span class="details-value">{{ifscCode}}</span>
        </div>
      </div>
      {{/if}}
    </div>

    {{#if termsAndConditions}}
    <div class="terms-section">
      <h4>Terms & Conditions</h4>
      <p>{{termsAndConditions}}</p>
    </div>
    {{/if}}

    <div class="signature-section">
      <div class="signature-box">
        <div class="signature-line">Recipient's Acknowledgement</div>
      </div>
      <div class="signature-box">
        {{#if signatureImage}}
        <img src="{{signatureImage}}" alt="Signature">
        {{/if}}
        <div class="signature-line">
          Authorised Signatory<br>
          {{#if signatoryName}}<strong>{{signatoryName}}</strong>{{/if}}
          {{#if signatoryDesignation}}<div class="designation">{{signatoryDesignation}}</div>{{/if}}
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="footer-row"><strong>PAN No.:</strong> {{panNumber}} | <strong>CIN:</strong> {{cinNumber}}</div>
      <div class="footer-row"><strong>Regd. Office:</strong> {{registeredAddress}}</div>
      {{#if footerNote}}
      <div class="footer-row" style="margin-top: 5px; font-style: italic;">{{footerNote}}</div>
      {{/if}}
    </div>
  </div>
</body>
</html>
